
USE GRAPH xgraph
SET query_timeout = 600000
DROP QUERY client_cosinesim_load_cache, client_cosinesim_match_sw


CREATE QUERY client_cosinesim_load_cache() FOR GRAPH xgraph {
    cosinesim_cache_to_vertices();
}


create query client_cosinesim_match_sw(VERTEX<patients> newPatient, UINT topK) FOR GRAPH xgraph {
    ListAccum<testResults> @@result;
    @@result = cosinesim_match_sw(newPatient, topK);
    PRINT "Software UDF" AS ComputationTechnique;
    PRINT newPatient.FIRST_NAME + " " + newPatient.LAST_NAME AS Patient;
    PRINT @@result AS Matches;
}


INSTALL QUERY client_cosinesim_load_cache, client_cosinesim_match_sw
